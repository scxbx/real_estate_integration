## real_estate_integration

#### deal_with_data.py

![deal_with_data](.\pictures\deal_with_data.PNG)



本软件用于识别身份证和户口本以生成挂接表。使用方法如下：

1. 通常使用ocr识别来生成表格：

   a. 输入村小组名称

   b. 点击“ocr识别”，选择文件夹（通常为“02电子档案”），程序开始识别，直到命令行出现“获取信息完成”。此时，在“02电子档案”同级可以看到文件夹“02电子档案json”，这是文字识别结果的最原始材料，需要保存。

   c. 点击“写入excel”，很快可以看到“写入结果\...\挂接表.xlsx完成”和“写入结果\...\家庭成员核查反馈.txt完成”

   d. 在“结果”文件夹可以看到新生成的文件夹

2. 如果已使用过ocr识别过一个村小组，但因为各种原因需要重新生成挂接表，可以使用本地数据直接生成：

   a. 输入村小组名称 

   b. 点击“本地数据”，选择文件夹（通常为“02电子档案”），确保旁边有json文件夹（通常为“02电子档案json”。（或者点击“本地数据json”，选择文件夹（通常为“02电子档案”））很快就能看到“获取信息完成”

   c. 点击“写入excel”，很快可以看到“写入结果\...\挂接表.xlsx完成”和“写入结果\...\家庭成员核查反馈.txt完成”
   d. 在“结果”文件夹可以看到新生成的文件夹

3. 在本软件下所在路径下的“json”文件夹中存有处理原始数据得到的数据，可通过这些数据生成挂接表：
   a. 输入村小组名称 
   b. 点击“选取文件夹并写入excel”，选择文件夹（通常为“json\{村小组名称}{时间}”），很快看到“写入结果\挂接表.xlsx完成 写入结果\家庭成员核查反馈.txt完成”



#### gen_cover.py

生成**不动产权属登记档案袋封面**。用法如下：

1. 确保根目录下存在**info.xlsx**和**cover.xlsx**

2. **info.xlsx**必须是如下形式：

   | 权利人名称  | 联系人  | 面积  | 不动产单元号  | 坐落  |
   | ----------- | ------- | ----- | ------------- | ----- |
   | 权利人名称1 | 联系人1 | 面积1 | 不动产单元号1 | 坐落1 |
   | 权利人名称2 | 联系人2 | 面积2 | 不动产单元号2 | 坐落2 |
   | 权利人名称3 | 联系人3 | 面积3 | 不动产单元号3 | 坐落3 |

3. 运行**gen_cover.py**

4. 几秒后**results**文件夹中会生成**result.xlsx**



#### parcel_property_sheet.py

<img src=".\pictures\parcel_property_sheet.PNG" alt="parcel_property_sheet.py" style="zoom:80%;" />

本程序用于生成房地一体项目的**宗地属性表**、**房屋属性表**和**公示表**。用法如下：

1. 确保**默认表格**文件夹中有**config.txt**、**成果模板-公示表.xlsx**、**挂接表模板.xlsx**和**陵水县配号申请信息表.xlsx**四个文件。

2. 选择路径并填写信息(标注为必填的必须要选，否则程序无法正常运行；**02电子档案**为选填，影响图片信息 CW101；**json文件夹路径**暂时不填；剩下的都有默认文件，可以不选)。

3. **调查员**、**测量人**的选项可以通过修改**.\默认表格\config.txt**自行调整。

<img src=".\pictures\config.PNG" alt="config.txt" style="zoom:80%;" />

4. 填完后，点击写入。
5. 新的**宗地属性表**和**房屋属性表**将**覆盖**原来的表，**公示表**将生成在**结果**文件夹里。



#### relational_transformation.py

将通过识别生成，并人工调整过错误的身份证、年龄、性别的挂接表中，对权利人不为户主的情况进行关系转换。用法如下：

1. 运行relational_transformation.py，然后选择要转换的挂接表，即可在**结果**文件夹自动生成**新挂接表.xlsx**和**关系转化反馈.txt**

2. 通过修改**.\关系转换\relation_list.txt**，添加新的关系（通过**逗号**隔开每个关系）

   <img src=".\pictures\relation_list.PNG" alt="relation_list" style="zoom:80%;" />

3. 通过修改**.\关系转换\relation.csv**，添加新的关系字典：新增一行，按顺序填入：

   a. 权利人关系

   b. 成员关系

   c. 转换后的成员关系（如果转换要用到年龄或关系，则填入   

   ​	性别为男且比权利人大的关系,

   ​	性别为男且比权利人小的关系,

   ​	性别为女且比权利人大的关系,
   ​	性别为女且比权利人小的关系
   ​	例如"兄弟,兄弟,姐,妹"、"儿子,儿子,女儿,女儿")



#### update_zong_code.py

本软件用于**更新**挂接表的**宗地号**。用法如下：

1. 运行**update_zong_code.py**
2. 选择文件夹**02电子档案**
3. 选择**挂接表**
4. 新的挂接表会**覆盖**原来的挂接表